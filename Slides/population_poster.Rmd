---
title: "Testing axioms of stochastic discrete choice using population choice probabilities"
author:
- William McCausland^[Université de Montréal (Economics)]
- Tony Marley^[Univerity of Victoria (Psychology)]
- Clint Davis-Stober^[University of Missouri (Psychology)]
date: "`r format(Sys.time(), '%d %B %Y')`"
output: pdf_document
header-includes:
- \usepackage[fontsize=14pt]{scrextend}
- \usepackage{amssymb}
- \usepackage{float}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.pos='H')
```

### Key words

* Axiomatic decision theory
    - Axioms here are restrictions on choice probabilities across choice sets.
    - They can be thought of as sets of moment inequalities.

* Discrete choice
    - Choice is abstract here; we are not modeling utility as a function of object attributes. 
    - We are concerned with *population*, not individual choice probabilities.
    
* Experimental economics
    - We ran a choice experiment featuring many different choice domains.
    
* Model evaluation, Bayes factors
    - We test several axioms and conditions using Bayes factors.

* MCMC, posterior simulation
    - This is an important part of the paper, but is not emphasised here.
    
\pagebreak

# Random choice and random preference

### Definitions

* $T = \{x_1,\ldots,x_n\}$ is a universe of choice objects.

* $P_A(x)$ is the probability that object $x \in A$ is chosen when choice set $A \subseteq T$ is presented.

* Convenient shortcut : $p(x,y) \equiv P_{\{x,y\}}(x)$.

* A *random choice structure* (RCS, denoted $P$) is a complete specification of the $P_A(x)$, $x \in A \subseteq T$.

* A *random preference* is a specification of the probability $\pi(x_{i_1},\ldots,x_{i_n})$ of each permutation $(x_{i_1},\ldots,x_{i_n})$ of $(x_1,\ldots,x_n)$.

* A random preference $\succ$ *induces* a random choice structure if for all $x \in A \subseteq T$, $P_A(x) = \sum_{i_2,\ldots,i_n} \pi(x,x_{i_2},\ldots,x_{i_n})$.

### Example, for $T=\{x,y,z\}$

* A random choice structure specifies choice probabilities
    - $p(x,y)$ and $p(y,x)$ for the choice set $\{x,y\}$,
    - $p(y,z)$ and $p(z,y)$ for the choice set $\{y,z\}$,
    - $p(x,z)$ and $p(z,x)$ for the choice set $\{x,z\}$,
    - $P_T(x)$, $P_T(y)$ and $P_T(z)$ for the choice set $T=\{x,y,z\}$.

* A random preference specifies preference probabilities
    - $\pi(x,y,z)$, $\pi(x,z,y)$, $\pi(y,x,z)$, $\pi(y,z,x)$, $\pi(z,x,y)$, $\pi(z,y,x)$.

* Two of the probabilities induced by a random preference :
$$ P_T(x) = \pi(x,y,z) + \pi(x,z,y) $$
$$ p(x,y) = \pi(x,y,z) + \pi(x,z,y) + \pi(z,x,y) $$

* Note the implication that $P_T(x) \geq p(x,y)$. Random preference---equivalent to random utility for finite choice universes---is restrictive.

\pagebreak

# An explanation of the ternary plots

* The simplex diagram shows a random choice structure for $T=\{x,y,z\}$ using Barycentric coordinates.

* On one diagram, we plot four different probability spaces.
    - A hollow dot on the left side of the triangle gives $p(x,y)$ and $p(y,x)$
    - A hollow dot on the base gives $p(y,z)$ and $p(z,y)$.
    - A hollow dot on the right side gives $p(x,z)$ and $p(z,x)$.
    - A solid dot (usually in the interior) gives $P_T(x)$, $P_T(y)$, $P_T(z)$.

* On the same diagram, we plot two regions in the interior consistent with
the given binary probabilities
    - Regularity (blue)
    - Multiplicative inequality (red)
    
```{r simplex, echo=FALSE, fig.height=5, fig.align='center'}
library(MASS)
library(klaR)
source('R Simplices/simplex.R')

binary.pch=1
ternary.pch=20

triplot(label=c('x', 'y', 'z'))

pxy = 0.6
pyx = 1-pxy
pxz = 1/2
pzx = 1-pxz
pyz = 0.60
pzy = 1-pyz
PTx = 1/4
PTy = 1/4
PTz = 1/2

# Sides of triangle
tripoints(pxy, pyx, 0.0, pch=binary.pch)
tripoints(0.0, pyz, pzy, pch=binary.pch)
tripoints(pxz, 0.0, pzx, pch=binary.pch)

text(tritrafo(pxy, pyx, 0.0), pos=2, "p(x,y) = 0.6")
text(tritrafo(0.0, pyz, pzy), pos=4, "p(y,z) = 0.6")
text(tritrafo(pxz, 0.0, pzx), pos=1, "p(x,z) = 0.5")

# Interior
triperplines(PTx, PTy, PTz, pch=ternary.pch, lcol='grey')
text(tritrafo(PTx, PTy, PTz), pos=1, 'P'['T'])

# Regularity and multiplicative regions
pmin.x = pxy*pxz
pmax.x = min(pxy, pxz)
pmin.y = pyx*pyz
pmax.y = min(pyx, pyz)
pmin.z = pzx*pzy
pmax.z = min(pzx, pzy)

cycle = pxy + pyz + pzx
reg.col='blue'
mul.col='red'
if (cycle <= 2 & cycle >= 1) {
  trilines(c(pmax.x, pmax.x, 1-pmax.y-pmax.z, pmax.x),
           c(pmax.y, 1-pmax.x-pmax.z, pmax.y, pmax.y),
           c(1-pmax.x-pmax.y, pmax.z, pmax.z, 1-pmax.x-pmax.y), col=reg.col)
}
trilines(c(pmin.x, pmin.x, 1-pmin.y-pmin.z, pmin.x),
         c(pmin.y, 1-pmin.x-pmin.z, pmin.y, pmin.y),
         c(1-pmin.x-pmin.y, pmin.z, pmin.z, 1-pmin.x-pmin.y),
         col=mul.col)
```

\pagebreak

# Some axioms of probabilistic discrete choice

### Weak stochastic transitivity (WST)

$$ \forall x,y,z\in T,\; p(x,y) \geq \tfrac{1}{2} \;\mbox{and}\; p(y,z) \geq \tfrac{1}{2} \rightarrow p(x,z) \geq \tfrac{1}{2}. $$

### Moderate stochastic transitivity (MST)

$$ \forall x,y,z\in T,\; p(x,y) \geq \tfrac{1}{2} \;\mbox{and}\; p(y,z) \geq \tfrac{1}{2} \rightarrow p(x,z) \geq \min[p(x,y),p(y,z)]. $$

### Strong stochastic transitivity (SST)

$$ \forall x,y,z\in T,\; p(x,y) \geq \tfrac{1}{2} \;\mbox{and}\; p(y,z) \geq \tfrac{1}{2} \rightarrow p(x,z) \geq \max[p(x,y),p(y,z)]. $$

### Triangle inequality (TI)

$$ \forall x,y,z\in T,\; p(x,y) + p(y,z) \geq p(x,z). $$

***

### Regularity (Reg)

$$ \forall A,B \subseteq T, x\in A,\; P_{A\cup B}(x) \leq P_A(x). $$

### Multiplicative inequality (Mul)

$$ \forall A,B \subseteq T, x\in A\cap B,\; P_{A\cup B}(x) \geq P_A(x) P_B(x). $$

### Random preference or random utility (RU)

$$ \forall x \in A \subseteq T,\; \sum_{B \colon A \subseteq B \subseteq T} (-1)^{|B \backslash A|} P_B(x) \geq 0. $$

\pagebreak

# Some of what is known about these axioms

### Logical relationships among them

This is a complete set of logical relationships among these axioms. In particular, the absence of arrows is informative.

$$
\begin{array}{ccccc}
\mathrm{SST} & \rightarrow & \mathrm{MST} & \rightarrow & \mathrm{WST} \\ 
&  &  & \searrow &  \\ 
\mathrm{RU} & \rightarrow & \mathrm{Reg} & \rightarrow & \mathrm{TI} \\ 
&  &  &  &  \\ 
&  & \mathrm{MI} &  &  \\ 
\end{array}
$$

### Other theorems

* $\mathrm{MI}$ is a necessary condition for independent random utility and for Elimination by Aspects models.

* $\mathrm{TI}$ is a necessary condition for binary random utility; it is also sufficient for $n \leq 5$.

* $\mathrm{RU}$, $\mathrm{Reg}$ and $\mathrm{TI}$ demarcate convex sets and therefore aggregate in population choice probabilities. The other axioms do not.

### Empirical evidence

* The most compelling evidence against $\mathrm{Reg}$ and $\mathrm{RU}$ is the asymmetric dominance effect (see next page).

* It is difficult to falsify $\mathrm{WST}$ and $\mathrm{TI}$, but a minority of subjects in some choice environments do so.

* There is strong evidence against $\mathrm{SST}$.

* There is very little empirical evidence regarding $\mathrm{MI}$, even though it is necessary for Elimination by Aspects.

* Documented in Rieskamp, Busemeyer and Mellers (JEL, 2006) Extending the Bounds of Rationality: Evidence and Theories of Preferential Choice

# The Asymmetric Dominance effect

### The context in which the effect is defined

* There are three objects in an attribute space over which preferences are thought to be monotonic: Target (T), Competitor (C) and Decoy (D)

* The Target vector-dominates the Decoy in the attribute space. Except for this, no object dominates another.

```{r asymdom, echo=FALSE, fig.height=4, fig.width=4, fig.align='center'}
x = c(0.2, 0.25, 0.75)
y = c(0.7, 0.75, 0.25)
plot(x, y,
  xlab="Level of attribute 1", ylab="Level of attribute 2",
  xlim=c(0, 1), ylim=c(0, 1))
text(x, y, c("Decoy", "Target", "Competitor"), pos=c(1,3,3))
```

### The effect

* The effect occurs when introducing the decoy to the choice set $\{T,C\}$ *increases* the probability of choosing the target: $P_{\{T,C,D\}}(T) > p(T,C)$.

* This is an obvious violation of regularity and therefore random utility.

### The evidence

* Reproducible effects are observed in some, but not all contexts.

* Effect more likely to be observed where attribute levels are numerical and transparently so.

* Again, see Rieskamp, Busemeyer and Mellers (2006).

\pagebreak

# More on the asymmetric dominance effect

### More qualitative detail on the assymmetric dominance effect

We see more than just $P_{\{T,C,D\}}(T) > p(T,C)$ in data:

* $p(D,T)$, $P_{\{T,C,D\}}(D)$ close to zero---in both choice sets, Target is feasible and dominates Decoy.
* $p(T,C)$ well in the interior of $(0,1)$ by design:
    - need room for probability of target to increase
    - Competitor can't be so much better than Target that noone switches.
* $p(D,C)$ close to $p(T,C)$ because $D$ is, by design, close to $T$.

```{r asymdombary, echo=FALSE, fig.height=3.5, fig.align='center'}
library(MASS)
library(klaR)
source('R Simplices/simplex.R')

binary.pch=1
ternary.pch=20

triplot(label=c('T', 'D', 'C'))

pxy = 0.95
pyx = 1-pxy
pxz = 0.25
pzx = 1-pxz
pyz = 0.20
pzy = 1-pyz
PTx = 0.4
PTy = 0.05
PTz = 0.55

# Sides of triangle
tripoints(pxy, pyx, 0.0, pch=binary.pch)
tripoints(0.0, pyz, pzy, pch=binary.pch)
tripoints(pxz, 0.0, pzx, pch=binary.pch)

# Two points
tripoints(PTx, PTy, PTz, pch=ternary.pch)

# Regularity and multiplicative regions
pmin.x = pxy*pxz
pmax.x = min(pxy, pxz)
pmin.y = pyx*pyz
pmax.y = min(pyx, pyz)
pmin.z = pzx*pzy
pmax.z = min(pzx, pzy)

cycle = pxy + pyz + pzx
reg.col='blue'
mul.col='red'
if (cycle <= 2 & cycle >= 1) {
  trilines(c(pmax.x, pmax.x, 1-pmax.y-pmax.z, pmax.x),
           c(pmax.y, 1-pmax.x-pmax.z, pmax.y, pmax.y),
           c(1-pmax.x-pmax.y, pmax.z, pmax.z, 1-pmax.x-pmax.y), col=reg.col)
}
trilines(c(pmin.x, pmin.x, 1-pmin.y-pmin.z, pmin.x),
         c(pmin.y, 1-pmin.x-pmin.z, pmin.y, pmin.y),
         c(1-pmin.x-pmin.y, pmin.z, pmin.z, 1-pmin.x-pmin.y),
         col=mul.col)
```

### An observation and some open questions

* The region where we see irregular choice is small, abuts the regular region.

* Do we see the same pattern in cases where dominance is not so obvious?

* Do we see other kinds of violations of regularity and of random utility?

* Can random utility models be modified to accommodate asymmetric dominance effects but in a disciplined way?

\pagebreak

# Experimental design

* $J=32$ choice domains, each with $n=5$ elements (generically, $a,b,\ldots,e$)

* $I=2^T-T-1=26$ choice subsets for each domain:
    + 10 doubletons: $\{a,b\}, \{a,c\}, \{a,d\}, \ldots, \{d,e\}$
    + 10 tripletons: $\{a,b,c\}, \{a,b,d\}, \{a,b,e\}, \ldots, \{c,d,e\}$
    + 5 quads: $\{a,b,c,d\}, \{a,b,c,e\}, \{a,b,d,e\}, \{a,c,d,e\}, \{b,c,d,e\}$
    + 1 quint: $\{a,b,c,d,e\}$

* $N = 1040$ subjects in the experiment.

* For each choice domain,
    + each choice set is presented to exactly 40 subjects, exactly once each
    + each subject is presented exactly one choice subset of that domain

* Randomization (uniform distributions, mutual independence)
    + Subjects see domains in random order
    + Choice set elements are presented in random order on screen
    + Random partition of 1040 subjects into 26 sets of size 40

* Recruitment and implementation
    + Recruitement of subjects by Survey Sample International (SSI)
    + Subjects reside in Canada. No restrictions on subject pool aside from those imposed by law (mainly age).
    + Implementation by Institute for Choice, University of South Australia.
    
* Comments on the design
    + No learning or attention issues within a domain.
    + Variety of choice sets keeps subjects engaged.
    + Strictly between-subject design makes the iid assumption reasonable.
    + A reasonably high number of observations for each choice set, compared to within-subject designs.
    + Using all subsets of the universe exposes *all* implications of random utility (and other axioms) to possible falsification.

\pagebreak

# Selected screenshots

![](./Population_study_design/screenshot_Coffee.png)
![](./Population_study_design/screenshot_Colours.png)
![](./Population_study_design/screenshot_Events.png)
![](./Population_study_design/screenshot_Travel.png)

\pagebreak

# Domains without numerical attributes

Domain               | Question
------------------- | -----------------------------------------------------------------
Male Stars          | Which movie star would you choose to have lunch with?
Female Stars        | Which movie star would you choose to have lunch with?
Films               | Judging from the following descriptions of films, which one of the films would you choose to see?
Colours             | Which one of the following colours do you like best?
Star Pairs          | Knowing only who is starring, which one of these new films would you choose to see?
Pizzas              | Which one of the following pizzas would you choose?
Juices              | Which one of the following fresh juices would you choose?
Colour Combos       | Which one of these colour combinations do you like best?
Events              | Which one of the following events do you think is most likely to happen in the next twenty years?
Radio formats       | Suppose you were on a two hour road trip and you have a choice among radio stations with the following formats. Which one would you choose?
Musical artists     | Which one of the following musical artists do you like the best?
Aboriginal art      | Which one of the following examples of Australian aboriginal art do you like the best?
Impressionist art   | Which one of the following examples of Impressionist art do you like the best?
Sentences           | Which one of the following sentences do you find the most grammatically acceptable?
Travel              | Which one of the following travel destinations would you most like to visit?
Marijuana           | Which one of the following marijuana policies would you choose?

\pagebreak

# Domains with an underlying objective truth

Domain               | Question
-------------- | -----------------------------------------------------------------
Latitude            | Which one of the following cities do you think is furthest north?
Dots                | Which one of the following boxes do you think has the greatest number of dots?
Triangles           | Which one of the following triangles do you think has the greatest area?
Population          | Which one of the following countries do you think has the largest population?
Surface area        | Which one of the following countries do you think has the greatest surface area, including inland bodies of water?

\pagebreak

# Domains with objects with two numerical attributes

Domain               | Question
------------------- | -----------------------------------------------------------------
Beer                | Below you will find three brands of beer. You know only the price per sixpack and the average quality ratings made by subjects in a blind taste test. Given that you had to choose one brand to buy on this information alone, which one would you choose?
Cars                | Which one of the following cars would you choose to drive, all other features begin equal? Ride quality is a on a scale of 0 to 100.
Restaurants         | Which one of the following restaurants would you choose for your next restaurant meal, based on transportation time (in minutes) and average customer ratings (from 1 to 5).
Flights             | Which one of the following flight itineraries would you choose? All involve two flights, with one layover between them.
Future payments     | Which one of the following would you choose?
Phone plans         | Of the following cell phone plans, which one would you choose? In all cases, unlimited calling, text picture and video messages to Canadian and international mobile numbers are included. Excess data usage is billed at $10 per 500 MB.
Hotel rooms         | Suppose you are staying over two nights in New York city. Which one of the following hotels would you choose, based on customer ratings and price per night?

\pagebreak

# Domains with objects with more than two attributes

Domain               | Question
-------------- | -----------------------------------------------------------------
Flights II          | Which one of the following flight itineraries would you choose? All involve two flights and have a total duration of six hours.
Televisions         | Which one of the following televisions would you choose to buy if you were in the market for a television? All are LED televisions. Resolution refers to number of horizontal lines. Smart indicates internet connectivity.
Coffee              | You need to buy 16oz of ground coffee for a brunch with friends. Which one of the following ground coffees would you choose?
Charity             | Suppose someone was donating a total of 100 dollars to a combination of charities, on your behalf. Which one of the following divisions of the 100 dollars would you choose?

\pagebreak

# Testing axioms using Bayes factors

* We are interesting in testing a particular axiom, such as random utility, for a particular choice domain.

* Some notation:
    + $\Delta$ is the space of random choice structures, a Cartesian product of simplices of different dimensions.
    + $\Lambda$ is the subset of $\Delta$ where the axiom of interest holds.
    + $f(P)$ is a prior density over $\Delta$ with full support.
    + $Y$ is the observed data and $\Pr[Y=y|P]$ is the probability mass function for the data (a product of 26 multinomial likelihoods) for a given random choice structure $P$.
    
* We compare two models:
    1. an encompassing model where all random choice structures are possible
    1. a restricted model where only those random choice structures satisfying the axiom are possible.
    
* The marginal likelihood (an out-of-sample prediction record) for the encompassing model is $\Pr[Y=y] = \int_\Delta \Pr[Y=y|P] f(P) \, dP$.

* The marginal likelihood for the restricted model is $\Pr[Y=y|P \in \Lambda]$.

* The Bayes factor in favour of the axiom is defined as the ratio of marginal likelihoods:
$$ \mathrm{BF} \equiv \frac{\Pr[Y=y|P \in \Lambda]}{\Pr[Y=y]} = \frac{\Pr[P \in \Lambda|Y=y]}{\Pr[P \in \Lambda]}, $$
and the second equation follows from Bayes rule (all the axioms have positive probability).

* The RHS is the ratio of posterior to prior probability of the axiom, for the encompassing model.
    + numerator favours the axiom to the extent it is probable given the data
    + denominator favours the axiom if it is `parsimonious'.

\pagebreak

# Prior and posterior axiom probabilities, \%: 

```{r pr.table, echo=FALSE, fig.height=5, fig.align='center'}
domain.names = c(
  'Prior',
	'Male stars',           # 1
	'Female stars',
	'Films',
	'Star pairs',
	'Pizzas',               # 5
	'Juices',
	'Colours',
	'Colour Combinations',
	'Events',
	'Radio formats',        # 10
	'Musical artists',
	'Aboriginal art',
	'Impressionist art',
	'Sentences',
	'Travel',               # 15
	'Marijuana',
	'Latitude',
	'Dots',
	'Triangles',
	'Population',           # 20
	'Surface area',
	'Beer',
	'Cars',
	'Restaurants',
	'Flight layovers',      # 25
	'Future payments',
	'Phone plans',
	'Hotel rooms',
	'Two-flight itineraries',
	'Televisions',          # 30
	'Coffee',
	'Charity')

result.table = read.table('Tables/population_single_model.txt')
row.names(result.table) = domain.names
alpha.table = result.table[,c('alpha0.05est', 'alpha0.25est', 'alpha0.50est', 'alpha0.75est', 'alpha0.95est')]
lambda.table = result.table[,c('lambda0.05est', 'lambda0.25est', 'lambda0.50est', 'lambda0.75est', 'lambda0.95est')]
pr.table = result.table[,c('wst.pr', 'mst.pr', 'sst.pr', 'ti.pr', 'reg.pr', 'ru.pr')]
BF.table = result.table[,c('wst.BF', 'mst.BF', 'sst.BF', 'ti.BF', 'reg.BF', 'ru.BF')]
knitr::kable(pr.table*100, col.names = c('WST','MST','SST','TI','Reg','RU'), digits = c(0,1,2,0,1,2))
```

\pagebreak

# Log Bayes factors in favour of axioms

```{r BF.table, echo=FALSE, fig.height=5, fig.align='center'}
knitr::kable(BF.table[2:33,], col.names = c('WST','MST','SST','TI','Reg','RU'), digits = c(1,1,1,1,1,1))
```

![Colour domain](./Population_study_data/Simplexes/Colours.pdf)

![Coffee domain](./Population_study_data/Simplexes/Coffee.pdf)

![Flight layovers domain](./Population_study_data/Simplexes/Flight_layovers.pdf)

![Latitude domain](./Population_study_data/Simplexes/Latitude.pdf)

![Juices domain](./Population_study_data/Simplexes/Juices.pdf)

![Female stars](./Population_study_data/Simplexes/Female_stars.pdf)
