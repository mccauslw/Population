---
title: "Testing axioms of stochastic discrete choice using population choice probabilities"
author:
- William McCausland^[Université de Montréal (Economics)]
- Tony Marley^[University of Victoria (Psychology)]
- Clint Davis-Stober^[University of Missouri (Psychology)]
date: "`r format(Sys.time(), '%d %B %Y')`"
output: beamer_presentation
header-includes:
- \usepackage{amssymb}
- \usepackage{float}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Background, definitions

* $P_A(x)$ is the probability that an individual drawn from a population chooses item $x$ when presented with finite choice set $A$.

* A *random choice structure* for a master set $T$ specifies $P_A(x)$, all $x \in A \subseteq T$.

* $\Delta$ is the set of all random choice structures on $T$.

* Falmagne (1978): A random choice structure $P$ can be induced by a random utility model iff for all $x \in A \subseteq T$,
$$\sum_{B \colon A \subseteq B \subseteq T} (-1)^{|B \backslash A|} P_B(x) \geq 0.$$

* Let $\Lambda$ be the set of random choice structures satisfying random utility; we will test the hypothesis $P \in \Lambda \subset \Delta$ against $P \in \Delta$.

## Broad research questions

Looking across a wide variety of choice environments, 

1. what regions of $\Delta$ outside $\Lambda$ are empirically relevant?
1. are some subregions of $\Delta$ more empirically relevant than others?

Notes:

* We are interesting in answering these for two kinds of choice probabilities: individual and population.

## A new discrete choice experiment

We designed and ran an experiment with these features:

1. There is a wide variety (32 in total) of choice domains, each with a master set of size five.
    - to say something general about choice
1. We present all doubleton and larger subsets of each master set, each one to 40 different participants.
    - to expose all implications of random utility (and other conditions) to possible falsification,
1. Each participant sees exactly one choice set from each domain.
    - to be confident that choices are independent (globally) and identically distributed (choice set by choice set).

## A consumer choice example

![Coffee](./Population_study_design/screenshot_Coffee.png)

## A judgement example

![Events](./Population_study_design/screenshot_Events.png)

## A visual example

![Travel](./Population_study_design/screenshot_Travel.png)

## Assignment of subjects to choice sets

![Assignment of subjects to choice sets](./Figures/RCM_SBIES_figure2.pdf)

## Testing conditions on $P$ using Bayes factors

Definitions:

* $\Lambda$ is the region where random utility (or some other condition) holds.

* $Y$ is data, $y$ the observed data.

The Bayes factor in favour of the restricted model against the encompassing model is
$$ \mathrm{BF} \equiv \frac{\Pr[Y=y|P \in \Lambda]}{\Pr[Y=y]} = \frac{\Pr[P \in \Lambda|Y=y]}{\Pr[P \in \Lambda]}. $$

## Log Bayes factors, first 16 domains

```{r pr.table, echo=FALSE, fig.height=5, fig.align='center'}
domain.names = c(
  'Prior',
	'Male stars',           # 1
	'Female stars',
	'Films',
	'Star pairs',
	'Pizzas',               # 5
	'Juices',
	'Colours',
	'Colour Combinations',
	'Events',
	'Radio formats',        # 10
	'Musical artists',
	'Aboriginal art',
	'Impressionist art',
	'Sentences',
	'Travel',               # 15
	'Marijuana',
	'Latitude',
	'Dots',
	'Triangles',
	'Population',           # 20
	'Surface area',
	'Beer',
	'Cars',
	'Restaurants',
	'Flight layovers',      # 25
	'Future payments',
	'Phone plans',
	'Hotel rooms',
	'Two-flight itineraries',
	'Televisions',          # 30
	'Coffee',
	'Charity')

result.table = read.table('Tables/population_single_model.txt')
row.names(result.table) = domain.names
alpha.table = result.table[,c('alpha0.05est', 'alpha0.25est', 'alpha0.50est', 'alpha0.75est', 'alpha0.95est')]
lambda.table = result.table[,c('lambda0.05est', 'lambda0.25est', 'lambda0.50est', 'lambda0.75est', 'lambda0.95est')]
BF.table = result.table[,c('wst.BF', 'mst.BF', 'sst.BF', 'reg.BF', 'ru.BF', 'mul.BF')]
knitr::kable(BF.table[2:17,], col.names = c('WST','MST','SST','Reg','RU','MI'), digits = c(1,1,1,1,1))
```

## Log Bayes factors, other 16 domains

```{r BF.table, echo=FALSE, fig.height=5, fig.align='center'}
knitr::kable(BF.table[18:33,], col.names = c('WST','MST','SST','Reg','RU','MI'), digits = c(1,1,1,1,1))
```

## Conclusions

1. For each choice domain, random utility is favoured, although never strongly.
1. Overall evidence in favour of random utility is compelling.
